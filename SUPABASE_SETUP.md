# üóÑÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase –¥–ª—è Flash Menu

## üöÄ –ß—Ç–æ —Ç–∞–∫–æ–µ Supabase?

**Supabase** - —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Firebase —Å PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- ‚úÖ **500MB –±–µ—Å–ø–ª–∞—Ç–Ω–æ** –Ω–∞–≤—Å–µ–≥–¥–∞
- ‚úÖ **PostgreSQL** –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- ‚úÖ **Real-time** –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π API**
- ‚úÖ **Dashboard** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### **–®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ Supabase**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [supabase.com](https://supabase.com)
2. –ù–∞–∂–º–∏—Ç–µ **"Start your project"**
3. –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ **GitHub** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
4. –ù–∞–∂–º–∏—Ç–µ **"New Project"**

### **–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**

1. **–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** `flashmenu`
2. **Database Password:** –ø—Ä–∏–¥—É–º–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å (–∑–∞–ø–∏—à–∏—Ç–µ!)
3. **Region:** –≤—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π:
   - **West Europe** (–§—Ä–∞–Ω–∫—Ñ—É—Ä—Ç) - –¥–ª—è –†–æ—Å—Å–∏–∏
   - **North America** (–û—Ä–µ–≥–æ–Ω) - –¥–ª—è –ê–º–µ—Ä–∏–∫–∏
4. –ù–∞–∂–º–∏—Ç–µ **"Create new project"**

**‚è±Ô∏è –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è:** 2-5 –º–∏–Ω—É—Ç

### **–®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí API**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - **Project URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://abcdefghijklmnop.supabase.co`)
   - **anon public key** (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `eyJ...`)

### **–®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `supabase-setup.sql`
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
4. –ù–∞–∂–º–∏—Ç–µ **"Run"**

**‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã, –∏–Ω–¥–µ–∫—Å—ã, –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### **1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `config.js`:**

```javascript
// config.js - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Flash Menu
// –ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ –≤ Git!

window.SUPABASE_CONFIG = {
    // –î–∞–Ω–Ω—ã–µ –∏–∑ Supabase Dashboard ‚Üí Settings ‚Üí API
    url: 'https://your-project-id.supabase.co',
    anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
};

window.GEMINI_CONFIG = {
    // –í–∞—à API –∫–ª—é—á Gemini
    apiKey: '[–í–ê–®_API_–ö–õ–Æ–ß]',
    baseUrl: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent'
};

console.log('‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
```

### **2. –û–±–Ω–æ–≤–∏—Ç–µ `index.html`:**

```html
<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Supabase -->
<script src="supabase-client.js"></script>

<!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è -->
<script src="config.js"></script>

<!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
<script src="app.js"></script>
```

### **3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ `app.js`:**

```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
let supabaseClient = null;

async function initSupabase() {
    if (window.SUPABASE_CONFIG) {
        try {
            supabaseClient = new SupabaseClient(
                window.SUPABASE_CONFIG.url,
                window.SUPABASE_CONFIG.anonKey
            );
            
            const isConnected = await supabaseClient.init();
            if (isConnected) {
                console.log('‚úÖ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω');
                await supabaseClient.createTables();
                return true;
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ Supabase:', error);
        }
    }
    
    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º localStorage');
    return false;
}

// –í—ã–∑–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', async function() {
    await initSupabase();
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
});
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
await supabaseClient.checkConnection();
// –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å true
```

### **2. –¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**

```javascript
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = await supabaseClient.registerUser(
    'test@example.com',
    'password123'
);
console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω:', user);
```

### **3. –¢–µ—Å—Ç –≤—Ö–æ–¥–∞:**

```javascript
// –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = await supabaseClient.loginUser(
    'test@example.com',
    'password123'
);
console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª:', user);
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **RLS (Row Level Security):**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ API endpoints

### **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–µ—Å—Å–∏–∏

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### **–¢–∞–±–ª–∏—Ü–∞ `users`:**
- `id` - UUID (—Å—Å—ã–ª–∫–∞ –Ω–∞ auth.users)
- `email` - email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `available_ingredients` - –º–∞—Å—Å–∏–≤ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### **–¢–∞–±–ª–∏—Ü–∞ `menus`:**
- `id` - UUID –º–µ–Ω—é
- `user_id` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `budget` - –±—é–¥–∂–µ—Ç
- `days` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π
- `meal` - —Ç–∏–ø –ø–∏—Ç–∞–Ω–∏—è
- `items` - JSON —Å –±–ª—é–¥–∞–º–∏
- `total_cost` - –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å

### **–¢–∞–±–ª–∏—Ü–∞ `products`:**
- `id` - UUID –∑–∞–ø–∏—Å–∏
- `user_id` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `products` - JSON —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏
- `updated_at` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **Project URL** –∏ **anon key**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç **–∞–∫—Ç–∏–≤–µ–Ω**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **—Ä–µ–≥–∏–æ–Ω** –ø—Ä–æ–µ–∫—Ç–∞

### **–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –≤ **SQL Editor**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RLS –≤–∫–ª—é—á–µ–Ω

### **–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ **Authentication**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ **Email auth** –≤–∫–ª—é—á–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **Site URL** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **Supabase Dashboard:**
- **Database** - –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü –∏ –¥–∞–Ω–Ω—ã—Ö
- **Authentication** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **API** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Logs** - –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—à–∏–±–æ–∫

### **–ú–µ—Ç—Ä–∏–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å localStorage

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è:**

```javascript
async function migrateFromLocalStorage() {
    if (!supabaseClient) return;
    
    const currentUser = await supabaseClient.getCurrentUser();
    if (!currentUser) return;
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
    const localData = {
        availableIngredients: JSON.parse(localStorage.getItem('availableIngredients') || '[]'),
        menus: JSON.parse(localStorage.getItem('menus') || '[]'),
        currentProducts: JSON.parse(localStorage.getItem('currentProducts') || '[]')
    };
    
    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å Supabase
    await supabaseClient.syncUserData(currentUser.id, localData);
    
    console.log('‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
}
```

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:

1. **‚úÖ –û–Ω–ª–∞–π–Ω –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** PostgreSQL
2. **‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
3. **‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
4. **‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
5. **‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** –¥–ª—è —Ä–æ—Å—Ç–∞
6. **‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ** –Ω–∞–≤—Å–µ–≥–¥–∞

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç** –Ω–∞ Supabase
2. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**
5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–Ω–ª–∞–π–Ω –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö!** üéâ 