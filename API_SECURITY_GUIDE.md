# 🔒 Безопасное хранение API ключей

## ⚠️ ВАЖНО: Безопасность API ключей

GitHub предупреждает об утечке API ключей! Давайте исправим это.

## 🚨 Проблема:

```
Ключ API Google
AIzaSyC1jOV62uVbRCL2Wb7E1dacps7YobyLhL4
Публичная утечка
№2 открыт2 часа назад
• Обнаружен секрет в app.js:3

Ключ API Google
AIzaSyDKVM2qJQ4lXfjZpQVm9ymxf_GiwMkDBHs
Публичная утечка
№1 открыт3 часа назад
• Обнаружен секрет в index.html:544
```

## ✅ Решение:

### **1. Используем секреты GitHub Actions:**
- **8 API ключей** хранятся в секретах GitHub
- **Никаких файлов** с ключами в репозитории
- **Автоматическое создание** config.js при деплое

### **2. GitHub Actions workflow:**
```yaml
- name: Create config.js from secrets
  run: |
    cat > config.js << 'EOF'
    window.GEMINI_CONFIG = {
      apiKey: '${{ secrets.GEMINI_API_KEY_1 }}',
      baseUrl: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent'
    };
    EOF
```

### **3. Сервер загружает ключи из переменных окружения:**
- `server-advanced.js` - ключи из `process.env`
- `app.js` - конфигурация из GitHub Actions
- `index.html` - безопасная загрузка

## 🔧 Как это работает:

### **Автоматическое переключение ключей:**
1. **Первый ключ** не работает → пробуем второй
2. **Второй ключ** не работает → пробуем третий
3. **И так далее** до 8 ключей
4. **Если все не работают** → используем Mock API

### **Безопасная загрузка:**
- Ключи загружаются из секретов GitHub Actions
- Никаких файлов с ключами в репозитории
- Автоматическое создание config.js при деплое
- Резервные ключи в коде (только для разработки)

## 🚀 Преимущества новой системы:

### **Надежность:**
- ✅ **8 API ключей** вместо 2
- ✅ **Автоматическое переключение** при ошибках
- ✅ **Fallback на Mock API** если все ключи не работают

### **Безопасность:**
- ✅ **Ключи не публикуются** в GitHub
- ✅ **Файл исключен** из репозитория
- ✅ **Безопасное хранение** локально

### **Производительность:**
- ✅ **Больше параллельных запросов** к разным проектам
- ✅ **Обход географических ограничений**
- ✅ **Распределение нагрузки** между ключами

## 📋 Что нужно сделать:

### **1. Добавьте секреты в GitHub:**
- Перейдите в **Settings** → **Secrets and variables** → **Actions**
- Добавьте 8 секретов `GEMINI_API_KEY_1` до `GEMINI_API_KEY_8`

### **2. Сделайте push в main:**
```bash
git push origin main
```

### **3. GitHub Actions автоматически:**
- Создаст `config.js` из секретов
- Развернет приложение на GitHub Pages
- Настроит безопасную работу с API

### **4. Проверьте работу:**
- Откройте GitHub Pages
- Попробуйте сгенерировать меню
- Посмотрите в логи Actions

## 🔍 Проверка безопасности:

### **В логах GitHub Actions должно быть:**
```
✅ Create config.js from secrets
✅ Setup Pages
✅ Upload artifact
✅ Deploy to GitHub Pages
```

### **В GitHub не должно быть:**
- ❌ API ключей в коде
- ❌ Файлов с ключами
- ❌ Предупреждений о утечке секретов
- ✅ Секреты в **Settings** → **Secrets and variables** → **Actions**

## 🌟 Результат:

После исправления:
- ✅ **8 API ключей** работают автоматически
- ✅ **Безопасное хранение** без утечек
- ✅ **Автоматическое переключение** при ошибках
- ✅ **GitHub не предупреждает** об утечках
- ✅ **Высокая надежность** работы приложения

## 🎯 Дополнительные меры безопасности:

### **Для продакшена:**
1. **Используйте переменные окружения**
2. **Храните ключи в секретах GitHub Actions**
3. **Используйте сервисы управления секретами**

### **Для разработки:**
1. **Файл `api-keys.js` локально**
2. **Не коммитьте в Git**
3. **Используйте резервные ключи**

---

**Теперь ваши API ключи в безопасности!** 🔒✅ 